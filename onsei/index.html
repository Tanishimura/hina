<!doctype html>
<html lang="ja">
	<head>
		<title>Sample01</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no">
		<!-- reset.css ress -->
		<!-- <link rel="stylesheet" href="https://unpkg.com/ress/dist/ress.min.css" /> -->
		<link rel="stylesheet" href="css/style.css">
		<script src="js/jquery-3.5.1.min.js"></script>
	</head>

	<body>
		<h1>音声認識（テキスト起こし）</h1>
		<p>
			触らないまましばらく時間がたつと、音声認識が自動的にオフになる仕様のため、時間をおくと音声認識がされない場合があります。<br>
			その際には「音声認識再開」ボタンを押すことで、音声認識を再開させられます。
		</p>
		<!-- イベント起動用のボタン -->
		<button id="btn1">音声認識再開</button>
		<br>
		<br>

		<!-- 表示操作用のdiv -->
		<div id="contena">音声認識だよ<br></div>

	<script src="js/script.js"></script>
	<script>
		SpeechRecognition = webkitSpeechRecognition || SpeechRecognition;
		const recognition = new SpeechRecognition();
		if ('SpeechRecognition' in window) {
			// ユーザのブラウザは音声合成に対応しています。
			console.log("ユーザのブラウザは音声合成に対応しています。");
			contena.innerHTML = "ユーザのブラウザは音声合成に対応しています。<hr>";
		} else {
			// ユーザのブラウザは音声合成に対応していません。
			console.log("ユーザのブラウザは音声合成に対応していません。");
			contena.innerHTML = "ユーザのブラウザは音声合成に対応していません。<hr>";
		}

		// recognition.interimResults = true; // 途中でも認識するようにする設定
		recognition.continuous = true;	// ずっと認識させる
	  
		recognition.addEventListener('result', (event) => { 
			// alert(event.results[0][0].transcript);
			console.log(event.results[event.results.length-1][0].transcript);
			contena.innerHTML += event.results[event.results.length-1][0].transcript;

			// 発言が終了したかどうか。
			if(event.results[0].isFinal){
				contena.innerHTML += "<br>";
			}
		})

		recognition.start();
	  </script>
	</body>
</html>
